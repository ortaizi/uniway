# ğŸ“¦ Makefile ×œÖ¾Uniway Backend â€“ ×’×¨×¡×” ××§×¦×•×¢×™×ª

# ğŸ§± ××©×ª× ×™× ×›×œ×œ×™×™×
VENV = venv
PYTHON = $(VENV)/bin/python
PIP = $(VENV)/bin/pip
ENV_FILE = .env

# ğŸ“¦ ×”×ª×§× ×ª ×—×‘×™×œ×•×ª
install:
	$(PIP) install -r requirements.txt

# ğŸš€ ×”×¨×¦×ª ×”×©×¨×ª (××§×•××™)
run:
	$(PYTHON) core/main.py

# ğŸ§ª ×”×¨×¦×ª ×›×œ ×”×‘×“×™×§×•×ª
 test:
	PYTHONPATH=./ $(VENV)/bin/pytest -v tests/

# ğŸ§ª ×”×¨×¦×ª ×‘×“×™×§×” ×¡×¤×¦×™×¤×™×ª (×œ××©×œ ×”×ª×—×‘×¨×•×ª)
test-login:
	PYTHONPATH=./ $(VENV)/bin/pytest -v tests/auth/test_login.py -k "test_login_success"

# ğŸ“„ ×”×§×¤××ª ×ª×œ×•×™×•×ª
freeze:
	$(PIP) freeze > requirements.txt

# â™»ï¸ ××—×™×§×ª ×§××© ×•×§×‘×¦×™× ×–×× ×™×™×
clean:
	rm -rf __pycache__ */__pycache__ .pytest_cache

# ğŸ§ª ×§×™×¦×•×¨ ×“×¨×š ×œ×‘×“×™×§×” ×©×œ moodle scraper
test-scraper:
	PYTHONPATH=./ $(VENV)/bin/pytest -v tests/scraper/test_moodle_scraper.py

# âš™ï¸ ×”×¨×¦×ª ×‘×“×™×§×•×ª ×¢× coverage (×“×•×¨×© ×”×ª×§× ×ª coverage)
coverage:
	PYTHONPATH=./ $(VENV)/bin/coverage run -m pytest
	$(VENV)/bin/coverage report -m
